
\chapter{Podaci i metode} % Main chapter title

\label{Podaci i metode} % For referencing 

Cilj rada je ispitivanje veze između molekulske funkcije proteina i njegove
(ne)uređenosti tj. da li molekulska funkcija zavisi više od uređenosti ili
neuređenosti. Istraživanje je motivisano radom \textit{"Functional anthology of
intrinsic disorder. 1. Biological processes and functions of proteins with long
disordered regions"} \parencite{Xie2007}. Navedeni rad je prvi u seriji od 
tri rada i bavi se prvenstveno biološkim procesima i molekulskim funkcijama.
U nastavku teksta pod terminima \keyword{originalni} rad, autori, podaci, metode i slično 
podrazumevaćemo navedeni rad njegve autore, metode, podatke itd.

Najveća razlika u našim pristupima je što su originalni rezultati izraženi u
terminima \keyword{ključnih reči} dok su naši rezultati izraženi u \keyword{GO
terminima}. Oba pristupa proizvode listu funkcija koje više obuhvataju
(ne)uređene proteine, ali GO termini zbog granularnosti se prirodnije
predstavljaju grafovski i sadrže mnogo više informacija. Konačni rezultat
ovog istraživanja predstavlja poređenje ova dva pristupa.


\section {Podaci}

Za metode koje prezentujemo potrebne su tri vrste informacija:
\begin{enumerate}
  \item Što više različitih proteina
  \item Pouzdana anotacija funkcija
  \item Informacije o funkcijama, prvenstveno međurelacije\\
    (Međurelacije između funkcija su bitne  ako ih je potrebno grupisati)
\end{enumerate}


\subsection{Podaci iz originalnog rada}

U originalnom radu \parencite{Xie2007} korišćena je  baza podataka 
\keyword{\swissprot} Poglavlje \ref{svis-prot}, verzija 48 iz 2005.
Verzija 48 ima 201 560 proteina od kojih 196 326 imaju dužinu preko 40
aminokiselina (što je potrebno zbog Definicije \ref{pdis_def} u nastavku). Funkcije
pridružene proteinima izražene su \keyword{kontrolisanim vokabularom}
\en{controlled vocabulary} koga čine takozvane UniProtKB \keyword{ključne reči}
\en{keywords}. U verziji 48, UniProtKB sadrži 874 ključnih reči.  Zbog
statističke značajnosti posmatrane su one ključne reči kojima je bilo anotirano
barem 20 proteina, tj. 710 ključnih reči.

Kao što je pomenuto u Poglavlju \ref{svis-prot} kanonske sekvence (proteini) u \swissprot
bazi podataka nisu redundantne u smislu da jedan unos u bazi podataka predstavlja produkt
jednog gena iz jedne vrste organizma. Međutim za analizu funkcija
\swissprot \keyword{jeste statistički redundantna} \parencite{proveriti} jer
sadrže veliku količinu \keyword{homologih} proteina (prvenstveno ortologa).
Originalni autori izvršili su klasterovanje \swissprot
proteina u \keyword{proteinske familije} dobivši 27 217 familija. Pri klasterovanju svaki protein
ima težinu kojom doprinosi daljoj analizi. Težina svakog proteina u preseku
klastera sa datom funkcijom je obrnuto proporcionalna veličini preseka
tako da je zbir težina svih proteina jednaka veličini preseka.

% \textbf{komentar:} \\
% Ono što autori nisu elaborirali jeste da početni uslov od minimum 20 proteina
% po ključnoj reči možda nije dovoljan. Ako pretpostavimo zarad ilustracije
% normalnu raspodelu veličina klastera proteina, očekivali bi da klaster najčešće
% sadrži 7 proteina. Dakle iako je 50 proteina pridruženo nekoj funkciji ona
% verovatno ima pridruženih svega 7 familija proteina. Kako familija sadrži
% proteine pod pretpostavkom istog evolutivnog porekla njihova funkcija bi
% trebalo da je slična pa se onda postavlja pitanje da li je 7 familija dovoljno
% da bi se razmatrala data ključna reč. Ovo je primarno kritika za ključne reči
% jer one obično predstavljaju opšte pojmove.
%
% Sa druge strane za usko specijalizovane pojmove bila bi dovoljna jedna familija
% proteina jer bi ona predstavljala sve razne homologe (TODO Burkhard Rost,
% Termofili)

\subsection{Naši podaci}

Ugledom na \keyword{CASP} takimčenja, \keyword{CAFA} \en{Critical Assessment of
Functional Annotation} takmičenje pokrenuto je zarad objektivnog ocenjivanja
prediktora funkcije i usmerivanja budućeg razvoja prediktora funkcije
\parencite{CAFA}.  U ovom radu korišćen je trening skup proteina preuzet sa
\keyword{CAFA3} takmičenja korišćen za treniranje prediktora funkcije.

CAFA3 trening skup (u nastavku samo CAFA3 skup ili CAFA3 podaci) je podskup \swissprot baze (iz 2016.) koji
uključuje sve proteine iz model organizama: \textit{Human, Mouse, Rat, S.
cerevisiae, S. pombe, E. coli, A. thaliana, Dictyostelium discoideum,
Zebrafish, Bacillus cereus. } sa izuzetokm sekvenci \textit{Drosophila and
Candida} koje su preuzete iz svojih respektivnih genomskih baza podataka.
Informacije o sadržaju CAFA3 trening skupa izneo je Iddo Friedberg PhD iz CAFA3 tima.
Naša analiza izvršena je pod pretpostavkom da  CAFA3 skup nije statistički redundantan.
Ova pretpostavka uporošćava metode analize.

TODO

% Iako ovaj pristup potencijalno proizvodi skup koji je \keyword{statisički
% redundantan} u našoj analizi smo pretpostavili da to nije slučaj jer je čin
% klasterovanja veoma računarski zahtevan, a nismo ubeđeni da je neophodan za
% ovaj konkretan skup. Iz tog razloga u daljoj analizi predstavljamo uprošćenu
% verziju formule koja ne uračunva težinu pojedinačnog proteina.

\swissprot proteini su kodirani jednim karakterom koristeći \keyword{IUPAC}
kodove.  U podacima javljaju se sekvence sa  21. i 22. aminokiselinom ('U' i 'O')
kao i  višeznačne oznake: 'B', 'J', 'X' i 'Z'.  Ovakve sekvence nisu podržane od
strane VSL2b prediktora i za nas predstavljaju nevalidne proteinske sekvence. Pod
\keyword{validnom proteinskom sekvencom} smatraćemo sekvencu koja je validan
ulaz za VSL2b, tj. čini je azbuka od 20 standardnih aminokiselina i
ima minimalnu dužinu 9 AK.

CAFA3 Podaci se sastoje od dve datoteke:
\begin{enumerate}
  \item \file{uniprot\_sprot\_exp.fasta}  sadrži 66 841 protein od kojih 66 599
    za našu analizu predstavljaju validnu proteinsku sekvencu. Od preostalih
    proteina 66 063 ima dužinu veću ili jednaku od 40 aminokiselina.
  \item \file{uniprot\_sprot\_exp.txt} pridružuje funkcije u obliku 
    \keyword{GO termina}. Zastupljeni su termini iz sva tri imenska prostora:
    16 117 ćelijskih komponenti, 5 966 molekulskih funkcija i 16 117 bioloških
    procesa. Jednom proteinu može biti pridruženo više GO termina i obrnuto.
\end{enumerate}

Naša analiza primarno je orijentisna na korišćenje GO termina za opis funkcije
i razlikuje se od originalnog pristupa.  Analiza sa GO terminima (grupisanje po
funkciji) zahteva prvenstveno poznavanje \textit{IS\_A} roditeljske veze između
termina. Takođe, tokom istraživanja bile su nam potrebne i ostale informacije o
terminima. Pomenute informacije dobili smo iz datoteke \cite{go_obo}
verzije 01.12.2017.

Radi poređenja dobijenih rezultata potrebno je poznavanje relacije između
ključnih reči i GO termina. Postoje dva dostupna mapiranja:
\begin{itemize}
  \item \cite{keywlist_txt} verzija 20.12.2017 sadrži
    detaljan opis 1188 ključnih reči od kojih 195 pripada kategoriji
    \keyword{Molekulskih funkcija}.  Od 195 samo 145 ima mapiranje na jedan ili
    više GO termina.
  \item \cite{uniprotkb_kw2go} sadrži samo
    mapiranja i generiše ih \keyword{GOA projekat} \parencite{Barrell2009}.
    Ipak ova mapiranja nisu korišćena jer su u našoj analizi proizvodila
    redundantna i nepoželjna mapiranja.
\end{itemize}

Pošto je originalni rad iz 2007. godine, postoje razlike u
vokabularu ključnih reči, razlike u samim sekvencama proteina, broj proteina i
anotacije ključnih reči na proteine.  Iz tog razloga, bilo je potrebno
prvo ponoviti analizu sa vokabularom ključnih reči da bi se procenilo koliko
ove razlike utiču na originalne rezultate.

Zbog toga CAFA3 podatke ne možemo da posmatramo kao crnu kutiju već je
bilo neophodno povezati ih sa \swissprot proteinima prvenstveno zbog
pridruživanja ključnih reči. Kako postoje razlike između najnovije verzije \swissprot
baze i CAFA3 podataka bilo je neophodno izvršiti ''korektno'' spajanje i
analizu razlika.  Informacije o pridruženim ključnim rečima takođe su nam bile
značajne za proveru validnosti mapiranja na GO termine i testiranje
potencijalnih drugih metoda mapiranja. Naša očekivanja su da iste funkcije
podrazumevaju anotaciju na iste proteine.  Ovi koraci detaljno su opisani u
Poglavnju \ref{Priprema_podataka}.



\section {Metod}


\textbf{Idealan slučaj.} 
Pretpostavimo da za proizvoljnu molekulsku funkciju znamo sve strukturno različite
proteine koji je obavljaju.  Da bi dali korektan odgovor  moramo da znamo kako
neuređenost pojedinačnog proteina utiče na
na njegovo ponašanje, i kako to ponašanje (tip neuređenosti) utiče na datu funkciju.
% Ova vrsta znanja nije bila dostupna 2007. osim za jako mali skup proteina.

\textbf{Realnost.} 
\begin{itemize}
  \item Broj eksperimentalno određenih neuređenih regiona je veoma mali.
    Baza eksperimentalno utvrđenih neuređenih regiona \keyword{Disprot} ima
    svega 803 proteina sa opisanih 2167 neuređenih regiona \parencite{Piovesan2016}.
    Nažalost pouzdanost ovih regiona je diskutabilna jer različite
    eksperimentalne tehnike koje su korišćene imaju različitu pouzdanost.
    Najveću pouzdanost nose regioni koji su eksperimentlano utvrđeni sa 
    većim brojem eksperimentalnih tehnika.
  \item Prediktori su trenirani na malom podskupu proteina iz Disprot i PDB  baze.
    Čak i konsenzus nekoliko različitih prediktora ne daje dovoljno pouzdane
    rezultate o lokaciji neuređenog regiona \parencite{Mitic}.
  \item 
    Pozitivna strana je najnoviji napredak, razvoj prediktora koji direktno
    pokušavaju da predvide funkciju koju IDPr obavlja \parencite{Meng_c2017}.
  % \item Koliko nam je poznato trenutno nema prediktora koji predviđaju tip
  %   neuređenosti. Takođe, Opisivanje tipa neuređenosti predstavlja poduhvat.
  %   \begin{itemize}
  %     \item Prof. Vladimir Uverski predlaže nekoliko imena za opis različitih
  %       ponašanja neuređenih proteina \en{Folldon, Unfolldon, ...}
  %       \parencite{Uversky2017}.
  %     \item Prof. Peter Tompa je zaslužan za kreiranje 3 ontologije neuređenih
  %       regiona za bazu Disprot koji precizno modeluje tipove
  %       neuređenosti \parencite{disprot}.  .  Međutim koliko nam je poznato
  %       prediktori koji predviđaju termine ove ontologije još nisu napravljeni
  %   \end{itemize}

\end{itemize}

Jednostavna alternativa je da se pretpostavi da veći udeo neuređenih u odnosu
na uređene proteine podrazumeva da funkcija zavisi više od neuređenosti. 
% Dakle izjednačavamo uzročnost \en{causation} i \keyword{korelaciju} između funkcije i neuređenosti.
Međutim, prvo je potrebno definisati kada protein smatramo
neuređenim.  Definicija mora da ima biološkog smisla, da bude prilagođena
analizi, ali pored takođe je ograničena sposobnostima i preciznošću prediktora
koji se korist.  Više o tome u narednom Podpoglavlju \ref{naredno}.

\subsection{Predikcija neuređenosti proteina}
\label{naredno}

Originalni autori koristili su \keyword{PONDR VL3E} prediktor koji
postiže tačnost od $~87\%$ pri unakrsnoj validaciji nad uravnoteženim test
skupom.  Zbog ekonomičnosti i dostupnosti u ovom radu korišćen je noviji
prediktor druge generacije \keyword{PONDR VSL2b}.
Relevantne karakteristike VSL2b detaljno su opisane u \ref{VSL2b}.
Za potrebe analize originalni autori  uvode sledeću definiciju:

\newtheorem{mydef}{Definicija}
\begin{mydef}
\label{pdis_def}
Protein je \keyword{putativno neuređen} (najverovatnije neuređen) \en {putatively disordered}
ako sadrži bar jedan region veći ili jednak od 40 uzastopnih aminokiselina
takvih da imaju \textit{predviđenu neuređenost} iznad 0.5. 
\end{mydef}

Onda definišemo operator $d$ takav da za svaku proteinsku sekvencu $s_i$ važi:

\[   
  d(s_i) = 
    \begin{cases}
      1 & \text{ako je} \quad s_i \quad \keyword{putativno neuređena}\\
      0 & \text{suprotno}
    \end{cases}
\]

U nastavku pod neuređenošću podrazumevaće se \keyword{putativna neuređenost}.
Uslov ''$\ge40$'' u originalnom radu delom je posledica ograničenja VL3
prediktora koji je treniran na \keyword{dugim} sekvencama\footnote{L označava
duge regione, $\ge$ 30 AK}.
% Mi nismo u obavezi da sledimo ovo pravilo, ali ga sledimo radi upoređivanja rezultata.

\subsection{Zavisnost dužine proteina i predikcije dugačkog neuređenog regiona}

Verovatnoća da po gornjoj definiciji protein bude klasifikovan kao verovatno
neuređen raste sa porastom njegove dužine. Ova činjenica  utiče
na statističku značajnost rezultata. Autori \parencite{Xie2007} 
predlažu narednu formulu da se ta verovatnoća proceni:

Neka je $S_L$ skup proteina sa dužinama iz intervala $[L-l, L+l]$ gde je $l
= 0.1 \cdot L$\footnote{Na primer, skup $S_{100}$ sadrži proteine iz invervala $[90, 100]$, a $S_{500}$ iz intervala $[450, 550]$}.
Dobijamo sledeće formule:

$$ S_L = \{s_i : \quad | L -  | s_i | | \le l \quad \}, \quad   |s_i| \text{ je dužina sekvence}  $$
$$ P_L = \dfrac{ \sum_{s_i \in S_L} d(s_i)} {| S_L |}, \quad   |S_L| \text{ je kardinalnost skupa}$$

Grafik funkcije $P_L$ u zavisnosti od promenljive $L$ predstavljen je na Slici
\ref{fig:PL1}.  Glatkoća rezulatata kontroliše se veličinom $l$ koja
predstavlja prozor uprosečavanja. Kako prozor uprosečavanja raste sa porastom
dužine proteina $(l = 0.1 \cdot L)$ tako $P_L$ postaje glađa sa veličinom
promenljive $L$.  Konstantni prozor uprosečavanja je tehnika još poznata
kao \en{rolling average} ili \en{boxcar filter} i predstavlja prostu vrstu
konvolucije.  Nije nam poznato  zašto su originalni autori odlučili da veličina
prozora raste sa dužinom proteina. Koliko nam je poznato u pitanju je heruistika.


\begin{figure}[th]
\centering
\includegraphics[]{plots/PL_F}
% \decoRule
\caption {
  Zavisnot neuređenosti i dužine CAFA3 proteina \\ minimalne dužine 40 AK
  \\ \footnotesize
  ($P_L$ sa prozorom uprosečavanja podrazumeva $l = 0.1L$, dok
  krstići predstavljaju sirove vrednosti $l = 0$. Transparentnost krstrića
  služi da ilustruje brojnost proteina date dužine. Ako je krstić transparentan
  znači da sadrži manje od 100 proteina.)
}
\label{fig:PL1}
\end{figure}


Pored gore prikazanog originalnog metoda biće predstavljen još jedan pristup
\keyword{Slučajno generisani} \en{random generated} proteini za procenu $P_L$.
Razmotrićemo dva modela. Prvi je naivni model \keyword{uniformne verovatnoće}
koji podrazumeva da se svaka aminokiselina javlja sa istom verovatnoćom odnosno
$1/20$. U statistici ovo je još poznato kao \en{equiprobable model}.  Drugi
model koji ćemo zvati 'slučajni' ili 'random' model predstavlja slučajnu
promenljivu čija verovatnoća zavisi od učestalosti aminokiselina iz CAFA3 skupa
i prikazana je na Slici \ref{fig:AK_ucestalost}.  Koristeći ova dva modela za
svaki protein generisan je slučajan protein iste dužine koji se koristi za
procenu $P_L$.


\begin{figure}[th]
\centering
\includegraphics[]{plots/AK_ucestalost}
% \decoRule
\caption{
  Učestalost aminokiselina u CAFA3 podacima
  \\ \footnotesize
  (Učestalost prikazuje uniformni model, dok boja AK obeležava afinitet prema
  uređenosti ili neuređenosti. Aminokiseline su poređane u rastućem poretku
  od najlakše do najteže. 
}
\label{fig:AK_ucestalost}
\end{figure}

Poređenje predloženih pristupa sa originalnim $P_L$ prikazano je na Slici
\ref{fig:PL2}. Jasno se vidi
da slučajni model predstavlja vizuelno dobru aproksimaciju dok uniformni model
znatno odstupa i dosta sporije raste (naizgled skoro linearno). Kako VSL2b
prediktor prepoznaje neuređene regione na osnovu učestalosti aminokiselina, ovo
ponašanje nije čudno jer je manja verovatnoća pojave aminokiselina koje
promovišu neuređenost. Zbog suviše velikog odstupanja uniformni model nije
korišćen u daljoj analizi.


\begin{figure}[th]
\centering
% \includegraphics[scale=0.65]{Figures/PL2}
\includegraphics[]{plots/PL_F_cmp}
% \decoRule
\caption{Upoređivanje modela za procenu $P_L$ nad CAFA3 podacima}
\label{fig:PL2}
\end{figure}


Jedno od objašnjenja zašto je uniformni model naivan i toliko odstupa od
prvobitnog metoda proizilazi iz činjenice da aminokiseline imaju inherentno
različite verovatnoće. Naime, aminokiseline ne mogu  imati istu
verovatnoću jer se  broj njihovih kodona razlikuje. Neke aminokiseline
su kodirane sa samo jednim, a druge i sa 6 kodona. Očekivano je da broj kodona
povećava učestalost aminokiseline i ta korelacija uz izuzetke arginina se vidi
na Slici \ref{fig:aminoacid} \parencite{AKfrekvencija}.

\begin{figure}[th]
\centering
\includegraphics[scale=0.7]{aminoacid}
% \decoRule
\caption{Očekivana i realna učestalost  aminokiselina kod sisara\\ \footnotesize
(Preuzeto sa: \url{www.tiem.utk.edu/~gross/bioed/webmodules/aminoacid.htm})}
\label{fig:aminoacid}
\end{figure}



\clearpage
\subsection{Ocenjivanje zavisnosti funkcije od neuređenosti}

Neka je $S_j$ skup proteina koji imaju pridruženu funkciju $j$. Tada se procenat
neuređenih proteina u oznaci $F_j$ može izračunati kao:
$$F_j = \dfrac{\sum_{s_i \in S_j} d(s_i)} {\Vert S_j \Vert} $$



Nulta hipoteza za $F_j$ je tvrdnja da $F_j$ zavisi samo od dužine sekvence tj. $P_L$. \\
Neka je $X_L$ Bernulijeva slučajna promenljiva oblika $X_L : \begin{pmatrix} 0 & 1\\ P_L & 1-P_L \end{pmatrix}$. \\
Tada nultu hipotezu modeliramo raspodelom $Y_j$, koja za razliku od $F_j$ koristi
slučajnu promenljivu $X_L$ umesto  $d(s_i)$, odnosno:


% Nultu hiptezu koja predviđa da je rezultat $F_j$ posledica samo slučajnosti, to
% jest zavisi samo od $P_L$ opisana je preko slučajne veličine $Y_j$ gde je $X_L$
% Bernulijeva slučajna veličina sa verovatnoćom $P(X_L = 0) = P_L$ odnosno $P(X_L
% = 1) = 1-P_L$

$$ Y_j = \dfrac {\sum_{s_i \in S_j} {X_{|s_j|}}}{\Vert S_j \Vert}$$

Ako $F_j$ izlazi iz intervala poverenja raspodele $Y_j$ onda, funkcija $j$
sadrži značajno mnogo predviđenih (ne)uređenih proteina. Preciznije,
ako je p-vrednost \en{p-value} $<0.05$ funkcija $j$ je povezana sa neuređenim
proteinima a, ako je \textit{p-value} $>0.95$ funkcija $j$ je povezana sa
uređenim proteinima. Suprotno ne može ništa da se tvrdi za funkciju $j$.  U
kada se kaže da je funkcija, ključna reč ili GO termin (ne)uređen
podrazumevaće se da je odgvorajauća p-vrednost manja od $<0.5$ ili veća
od $>0.95$.

Zbog $X_L$ teško je analitički proceniti $Y_j$, pa se se pribegava empirijskom
računanju p-vrednosti. Empirijska p-vrednost određena je tako što je za 1000
realizacija $Y_j$ izračunato očekivanje da je realizacija $Y_j$ veća od $F_j$.

Preciznije, vektor\footnote{zamenili smo skupa $S_j$ za vektor $S_j$. Ovo je implementacioni detalj}
$S_j$ sadrži $k$ prteina $S_j=\{s_1, s_2, ... ,s_{k}\}$.
Protein $s_i$ ima dužinu $L_i$ za koju je izračunata verovatnoća $P_{L_i}$.
Tada generatorom Bernulijevih slučajnih brojeva, za svaki protein $p_i$ na
osnovu $P_{L_i}$ generišemo realizaciju $X_L$. Dobijen je vektor od $k$ vrednosti nula ili
jedan. Učestalost jedinica u dobijenom vektoru predstavlja prvu realizacija $Y_j$.
Postupak se ponavlja hiljadu puta i broji se koliko puta je realizacija $Y_j$
bila veća od $F_j$. Dobijeni zbir deli se sa 1000 i rezulatat je empirijska
p-vrednost.

% \begin{verbatim}
%     p = np.array( [yj>Fj for yj in Yj_1000] ).mean()
% \end{verbatim}

Originalni autori tvrde da se za veće skupove $S_j$, raspodela
$Y_j$ ponaša kao normalna. To znači da se ocena Z-skor može dobiti kao
$Z_j=(F_j-\mu_j)/\delta_j$ gde je $\mu_j$ očekivanje, a $\delta_j$ standardna
devijacija.  Dodatno, p-vrednost može da se aproksimira kao $1/2(1-erf(Z_j/2))$
\footnote{$erf()$ je gausova funkcija greške,
$erf(x)=\dfrac{2}{\sqrt{\pi}} \int_{0}^{x}  e^{-t^2} dt$ }
ako raspodela liči na normalnu. Ovo je nekad korisno jer sa 1000 realizacija
$Y_j$ nema dovoljnu preciznost za p vrednost manju od $1/1000=0.001$. Međutim u
ovom radu to nije korišćeno jer su sva sortiranja (kao i u originalnom radu)
izvršena po Z-skor oceni.


